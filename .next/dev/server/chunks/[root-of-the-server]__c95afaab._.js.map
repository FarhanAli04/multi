{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Clients%20era/CURRENT/v0-multi-vendor-e-commerce-website-main/v0-multi-vendor-e-commerce-website-main/lib/user-store.ts"],"sourcesContent":["// Shared user store for authentication demo\r\nexport interface User {\r\n  email: string\r\n  password: string\r\n  role: \"customer\" | \"seller\"\r\n  fullName: string\r\n  storeName?: string\r\n  username?: string\r\n  mobileNumber?: string\r\n  promoCode?: string\r\n  verificationStatus?: \"pending\" | \"approved\" | \"rejected\"\r\n  isVerified: boolean\r\n  createdAt: string\r\n}\r\n\r\n// Mock database - this will persist across API calls in development\r\nexport const users = new Map<string, User>([\r\n  // Pre-configured demo accounts\r\n  [\"seller@example.com\", {\r\n    email: \"seller@example.com\",\r\n    password: \"password123\",\r\n    role: \"seller\",\r\n    fullName: \"John Seller\",\r\n    storeName: \"John's Store\",\r\n    username: \"johnseller\",\r\n    mobileNumber: \"1234567890\",\r\n    promoCode: \"1234\",\r\n    verificationStatus: \"approved\",\r\n    isVerified: true,\r\n    createdAt: new Date().toISOString()\r\n  }],\r\n  [\"customer@example.com\", {\r\n    email: \"customer@example.com\", \r\n    password: \"password123\",\r\n    role: \"customer\",\r\n    fullName: \"Jane Customer\",\r\n    isVerified: true,\r\n    createdAt: new Date().toISOString()\r\n  }]\r\n])\r\n\r\nexport function createUser(userData: Omit<User, 'createdAt' | 'isVerified'>): User {\r\n  const user: User = {\r\n    ...userData,\r\n    isVerified: userData.role === \"customer\", // Customers are auto-verified\r\n    createdAt: new Date().toISOString()\r\n  }\r\n  \r\n  users.set(userData.email, user)\r\n  return user\r\n}\r\n\r\nexport function getUserByEmail(email: string): User | undefined {\r\n  return users.get(email)\r\n}\r\n\r\nexport function verifyUser(email: string, password: string): User | null {\r\n  const user = users.get(email)\r\n  if (!user || user.password !== password) {\r\n    return null\r\n  }\r\n  return user\r\n}\r\n"],"names":[],"mappings":"AAAA,4CAA4C;;;;;;;;;;;AAgBrC,MAAM,QAAQ,IAAI,IAAkB;IACzC,+BAA+B;IAC/B;QAAC;QAAsB;YACrB,OAAO;YACP,UAAU;YACV,MAAM;YACN,UAAU;YACV,WAAW;YACX,UAAU;YACV,cAAc;YACd,WAAW;YACX,oBAAoB;YACpB,YAAY;YACZ,WAAW,IAAI,OAAO,WAAW;QACnC;KAAE;IACF;QAAC;QAAwB;YACvB,OAAO;YACP,UAAU;YACV,MAAM;YACN,UAAU;YACV,YAAY;YACZ,WAAW,IAAI,OAAO,WAAW;QACnC;KAAE;CACH;AAEM,SAAS,WAAW,QAAgD;IACzE,MAAM,OAAa;QACjB,GAAG,QAAQ;QACX,YAAY,SAAS,IAAI,KAAK;QAC9B,WAAW,IAAI,OAAO,WAAW;IACnC;IAEA,MAAM,GAAG,CAAC,SAAS,KAAK,EAAE;IAC1B,OAAO;AACT;AAEO,SAAS,eAAe,KAAa;IAC1C,OAAO,MAAM,GAAG,CAAC;AACnB;AAEO,SAAS,WAAW,KAAa,EAAE,QAAgB;IACxD,MAAM,OAAO,MAAM,GAAG,CAAC;IACvB,IAAI,CAAC,QAAQ,KAAK,QAAQ,KAAK,UAAU;QACvC,OAAO;IACT;IACA,OAAO;AACT"}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///D:/Clients%20era/CURRENT/v0-multi-vendor-e-commerce-website-main/v0-multi-vendor-e-commerce-website-main/app/api/auth/login/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { verifyUser } from \"@/lib/user-store\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password } = await request.json()\r\n\r\n    // Validate input\r\n    if (!email || !password) {\r\n      return NextResponse.json({ error: \"Email and password are required\" }, { status: 400 })\r\n    }\r\n\r\n    // Verify user credentials\r\n    const user = verifyUser(email, password)\r\n    \r\n    if (!user) {\r\n      console.log(`[v0] Login failed for: ${email}`)\r\n      return NextResponse.json({ error: \"Invalid email or password\" }, { status: 401 })\r\n    }\r\n\r\n    // For sellers, check if they are verified\r\n    if (user.role === \"seller\" && !user.isVerified) {\r\n      return NextResponse.json({ \r\n        error: \"Your seller account is pending verification. Please wait for admin approval.\" \r\n      }, { status: 403 })\r\n    }\r\n\r\n    console.log(`[v0] Login successful: ${user.email}, role: ${user.role}`)\r\n\r\n    // Create session token (mock implementation)\r\n    const token = Buffer.from(`${email}:${Date.now()}`).toString('base64')\r\n    \r\n    // Create response with cookies\r\n    const response = NextResponse.json({\r\n      success: true,\r\n      user: {\r\n        email: user.email,\r\n        role: user.role,\r\n        fullName: user.fullName,\r\n        storeName: user.storeName\r\n      },\r\n      message: \"Login successful\"\r\n    })\r\n\r\n    // Set authentication cookies\r\n    response.cookies.set(\"auth_token\", token, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      sameSite: \"lax\",\r\n      maxAge: 60 * 60 * 24 * 7, // 7 days\r\n      path: \"/\"\r\n    })\r\n\r\n    response.cookies.set(\"user_role\", user.role, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      sameSite: \"lax\",\r\n      maxAge: 60 * 60 * 24 * 7,\r\n      path: \"/\"\r\n    })\r\n\r\n    response.cookies.set(\"user_email\", email, {\r\n      httpOnly: true,\r\n      secure: process.env.NODE_ENV === \"production\",\r\n      sameSite: \"lax\",\r\n      maxAge: 60 * 60 * 24 * 7,\r\n      path: \"/\"\r\n    })\r\n\r\n    return response\r\n\r\n  } catch (error) {\r\n    console.log(\"[v0] Login error:\", error)\r\n    return NextResponse.json({ error: \"Login failed\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,iBAAiB;QACjB,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkC,GAAG;gBAAE,QAAQ;YAAI;QACvF;QAEA,0BAA0B;QAC1B,MAAM,OAAO,IAAA,oIAAU,EAAC,OAAO;QAE/B,IAAI,CAAC,MAAM;YACT,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,OAAO;YAC7C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA4B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,0CAA0C;QAC1C,IAAI,KAAK,IAAI,KAAK,YAAY,CAAC,KAAK,UAAU,EAAE;YAC9C,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,OAAO;YACT,GAAG;gBAAE,QAAQ;YAAI;QACnB;QAEA,QAAQ,GAAG,CAAC,CAAC,uBAAuB,EAAE,KAAK,KAAK,CAAC,QAAQ,EAAE,KAAK,IAAI,EAAE;QAEtE,6CAA6C;QAC7C,MAAM,QAAQ,OAAO,IAAI,CAAC,GAAG,MAAM,CAAC,EAAE,KAAK,GAAG,IAAI,EAAE,QAAQ,CAAC;QAE7D,+BAA+B;QAC/B,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC,SAAS;YACT,MAAM;gBACJ,OAAO,KAAK,KAAK;gBACjB,MAAM,KAAK,IAAI;gBACf,UAAU,KAAK,QAAQ;gBACvB,WAAW,KAAK,SAAS;YAC3B;YACA,SAAS;QACX;QAEA,6BAA6B;QAC7B,SAAS,OAAO,CAAC,GAAG,CAAC,cAAc,OAAO;YACxC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACR;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,aAAa,KAAK,IAAI,EAAE;YAC3C,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACR;QAEA,SAAS,OAAO,CAAC,GAAG,CAAC,cAAc,OAAO;YACxC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ,KAAK,KAAK,KAAK;YACvB,MAAM;QACR;QAEA,OAAO;IAET,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,qBAAqB;QACjC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}