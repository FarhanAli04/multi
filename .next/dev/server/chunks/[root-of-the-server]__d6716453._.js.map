{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///D:/Clients%20era/CURRENT/v0-multi-vendor-e-commerce-website-main/v0-multi-vendor-e-commerce-website-main/app/api/auth/register/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\n\nexport async function POST(request: NextRequest) {\n  try {\n    const formData = await request.formData()\n\n    const role = (formData.get(\"role\") as string) || \"customer\"\n    const fullName = formData.get(\"fullName\") as string\n    const email = formData.get(\"email\") as string\n    const password = formData.get(\"password\") as string\n\n    // Validate basic fields\n    if (!fullName || !email || !password) {\n      return NextResponse.json({ error: \"Missing required fields\" }, { status: 400 })\n    }\n\n    // Validate password length\n    if (password.length < 8) {\n      return NextResponse.json({ error: \"Password must be at least 8 characters\" }, { status: 400 })\n    }\n\n    const apiBaseUrl = process.env.NEXT_PUBLIC_API_URL || process.env.API_URL || \"http://localhost:8000\"\n\n    const payload: any = {\n      email,\n      password,\n      role,\n      full_name: fullName,\n    }\n\n    if (role === \"seller\") {\n      const storeName = formData.get(\"storeName\") as string\n      const promoCode = (formData.get(\"promoCode\") as string) || \"\"\n      const mobileNumber = formData.get(\"mobileNumber\") as string\n      const username = formData.get(\"username\") as string\n\n      payload.phone = mobileNumber\n\n      payload.business_name = storeName || username || \"Seller Business\"\n      payload.store_name = storeName || username || `store_${Date.now()}`\n      payload.cnic_number = promoCode || username || `${Date.now()}`\n    }\n\n    const apiResponse = await fetch(`${apiBaseUrl}/api/auth/register`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify(payload),\n    })\n\n    const data = await apiResponse.json().catch(() => null)\n\n    if (!apiResponse.ok || !data?.success) {\n      return NextResponse.json({ error: data?.error || \"Registration failed\" }, { status: apiResponse.status || 500 })\n    }\n\n    return NextResponse.json(\n      {\n        success: true,\n        role: data.user?.role || role,\n        email: data.user?.email || email,\n        message: data.message || \"Registration successful\",\n      },\n      { status: 201 },\n    )\n  } catch (error) {\n    console.log(\"[v0] Register error:\", error)\n    return NextResponse.json({ error: \"Registration failed\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,WAAW,MAAM,QAAQ,QAAQ;QAEvC,MAAM,OAAO,AAAC,SAAS,GAAG,CAAC,WAAsB;QACjD,MAAM,WAAW,SAAS,GAAG,CAAC;QAC9B,MAAM,QAAQ,SAAS,GAAG,CAAC;QAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;QAE9B,wBAAwB;QACxB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,UAAU;YACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QAC/E;QAEA,2BAA2B;QAC3B,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAyC,GAAG;gBAAE,QAAQ;YAAI;QAC9F;QAEA,MAAM,aAAa,qEAAmC,QAAQ,GAAG,CAAC,OAAO,IAAI;QAE7E,MAAM,UAAe;YACnB;YACA;YACA;YACA,WAAW;QACb;QAEA,IAAI,SAAS,UAAU;YACrB,MAAM,YAAY,SAAS,GAAG,CAAC;YAC/B,MAAM,YAAY,AAAC,SAAS,GAAG,CAAC,gBAA2B;YAC3D,MAAM,eAAe,SAAS,GAAG,CAAC;YAClC,MAAM,WAAW,SAAS,GAAG,CAAC;YAE9B,QAAQ,KAAK,GAAG;YAEhB,QAAQ,aAAa,GAAG,aAAa,YAAY;YACjD,QAAQ,UAAU,GAAG,aAAa,YAAY,CAAC,MAAM,EAAE,KAAK,GAAG,IAAI;YACnE,QAAQ,WAAW,GAAG,aAAa,YAAY,GAAG,KAAK,GAAG,IAAI;QAChE;QAEA,MAAM,cAAc,MAAM,MAAM,GAAG,WAAW,kBAAkB,CAAC,EAAE;YACjE,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,MAAM,OAAO,MAAM,YAAY,IAAI,GAAG,KAAK,CAAC,IAAM;QAElD,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,MAAM,SAAS;YACrC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,MAAM,SAAS;YAAsB,GAAG;gBAAE,QAAQ,YAAY,MAAM,IAAI;YAAI;QAChH;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,MAAM,KAAK,IAAI,EAAE,QAAQ;YACzB,OAAO,KAAK,IAAI,EAAE,SAAS;YAC3B,SAAS,KAAK,OAAO,IAAI;QAC3B,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,wBAAwB;QACpC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAsB,GAAG;YAAE,QAAQ;QAAI;IAC3E;AACF"}}]
}