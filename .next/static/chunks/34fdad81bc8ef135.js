(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73518,e=>{"use strict";var t=e.i(47167),r=e.i(43476),a=e.i(71645);class s extends Error{}s.prototype.name="InvalidTokenError";let o={user:null,token:localStorage.getItem("token"),isAuthenticated:!1,isLoading:!0,error:null},n="LOGIN_START",l="LOGIN_SUCCESS",i="LOGIN_FAILURE",c="LOGOUT",u="REGISTER_START",d="REGISTER_SUCCESS",h="REGISTER_FAILURE",p="LOAD_USER_SUCCESS",m="LOAD_USER_FAILURE",g="CLEAR_ERROR",y=(e,t)=>{switch(t.type){case n:case u:return{...e,isLoading:!0,error:null};case l:case d:return{...e,user:t.payload.user,token:t.payload.token,isAuthenticated:!0,isLoading:!1,error:null};case i:case h:case m:return{...e,user:null,token:null,isAuthenticated:!1,isLoading:!1,error:t.payload};case c:return{...e,user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null};case"LOAD_USER":return{...e,isLoading:!0};case p:return{...e,user:t.payload,isAuthenticated:!0,isLoading:!1};case g:return{...e,error:null};default:return e}},f=(0,a.createContext)();e.s(["AuthProvider",0,({children:e})=>{let[b,x]=(0,a.useReducer)(y,o),w=t.default.env.REACT_APP_API_URL||"http://localhost:8000/api";(0,a.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(!e)return x({type:m,payload:"No token found"});try{let t=function(e,t){let r;if("string"!=typeof e)throw new s("Invalid token specified: must be a string");t||(t={});let a=+(!0!==t.header),o=e.split(".")[a];if("string"!=typeof o)throw new s(`Invalid token specified: missing part #${a+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(o)}catch(e){throw new s(`Invalid token specified: invalid base64 for part #${a+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new s(`Invalid token specified: invalid json for part #${a+1} (${e.message})`)}}(e);if(1e3*t.exp<Date.now()){localStorage.removeItem("token"),x({type:m,payload:"Token expired"});return}let r=await fetch(`${w}/auth/me`,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to load user");let a=await r.json();if(a.success)x({type:p,payload:a.user});else throw Error(a.error||"Failed to load user")}catch(e){localStorage.removeItem("token"),x({type:m,payload:e.message})}})()},[]);let S=async(e,t)=>{x({type:n});try{let r=await fetch(`${w}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=await r.json();if(a.success)return localStorage.setItem("token",a.token),x({type:l,payload:{user:a.user,token:a.token}}),{success:!0};throw Error(a.error||"Login failed")}catch(e){return x({type:i,payload:e.message}),{success:!1,error:e.message}}},v=async e=>{x({type:u});try{let t=await fetch(`${w}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(r.success)return localStorage.setItem("token",r.token),x({type:d,payload:{user:r.user,token:r.token}}),{success:!0};throw Error(r.error||"Registration failed")}catch(e){return x({type:h,payload:e.message}),{success:!1,error:e.message}}},j={...b,login:S,register:v,logout:()=>{localStorage.removeItem("token"),x({type:c})},clearError:()=>{x({type:g})}};return(0,r.jsx)(f.Provider,{value:j,children:e})},"useAuth",0,()=>{let e=(0,a.useContext)(f);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}],73518)},89954,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(73518),s=e.i(18566);function o(){let[e,o]=(0,r.useState)(""),[n,l]=(0,r.useState)(""),[i,c]=(0,r.useState)(!1),{login:u,error:d}=(0,a.useAuth)(),h=(0,s.useRouter)(),p=async t=>{t.preventDefault(),c(!0),(await u(e,n)).success&&h.push("/chat"),c(!1)};return(0,t.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"bg-white p-ped rounded-lg shadow-md w-full max-w-md",children:[(0,t.jsx)("h2",{className:"text-center text-2xl font-bold mb-6",children:"Login"}),d&&(0,t.jsx)("div",{className:"bg-red-100 text-red-700 p-3 rounded mb-4",children:d}),(0,t.jsxs)("form",{onSubmit:p,children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block mb-2 font-bold",children:"Email"}),(0,t.jsx)("input",{type:"email",value:e,onChange:e=>o(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500",placeholder:"Enter your email"})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsx)("label",{className:"block mb-2 font-bold",children:"Password"}),(0,t.jsx)("input",{type:"password",value:n,onChange:e=>l(e.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:border-blue-500",placeholder:"Enter your password"})]}),(0,t.jsx)("button",{type:"submit",disabled:i,className:`w-full py-2 rounded text-white ${i?"bg-gray-400":"bg-blue-500 hover:bg-blue-600"}`,children:i?"Logging in...":"Login"})]}),(0,t.jsx)("div",{className:"text-center mt-4",children:(0,t.jsxs)("p",{children:["Don't have an account? ",(0,t.jsx)("a",{href:"/register",className:"text-blue-500",children:"Register here"})]})}),(0,t.jsxs)("div",{className:"mt-6 p-4 bg-gray-100 rounded",children:[(0,t.jsx)("h4",{className:"font-bold mb-2",children:"Demo Account:"}),(0,t.jsxs)("p",{className:"text-sm",children:[(0,t.jsx)("strong",{children:"Admin:"})," admin@example.com / admin123"]})]})]})})}function n(){return(0,t.jsx)(a.AuthProvider,{children:(0,t.jsx)(o,{})})}e.s(["default",()=>n])}]);